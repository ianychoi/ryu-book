<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OpenFlow 스위치 테스트 도구 &mdash; Ryubook 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="top" title="Ryubook 1.0 documentation" href="index.html" />
    <link rel="next" title="아키텍처" href="arch.html" />
    <link rel="prev" title="QoS" href="rest_qos.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>탐색</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="전체 색인"
             accesskey="I">색인</a></li>
        <li class="right" >
          <a href="arch.html" title="아키텍처"
             accesskey="N">다음</a> |</li>
        <li class="right" >
          <a href="rest_qos.html" title="QoS"
             accesskey="P">이전</a> |</li>
        <li><a href="index.html">Ryubook 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="openflow">
<span id="ch-switch-test-tool"></span><h1>OpenFlow 스위치 테스트 도구<a class="headerlink" href="#openflow" title="제목 주소">¶</a></h1>
<p>이 장에서는 OpenFlow 스위치 OpenFlow 사양 준수의 정도를 검증하는
테스트 도구의 사용 방법을 설명합니다.</p>
<div class="section" id="id1">
<h2>테스트 도구의 개요<a class="headerlink" href="#id1" title="제목 주소">¶</a></h2>
<p>본 도구는 테스트 패턴에 따라 시험할 OpenFlow 스위치에
대해 플로우 항목 및 측정기 항목의 등록 / 패킷 적용을 수행하고,
OpenFlow 스위치의 패킷 재 작성 및 전송 (또는 삭제)의 처리 결과와
테스트 패턴 파일에 포함된 「기대하는 처리 결과」의 비교를 실행하여,
OpenFlow 스위치 OpenFlow 사양과 대응되는 상태를 확인하는 테스트 도구입니다.</p>
<p>도구는 OpenFlow 버전 1.3 및 OpenFlow 버전 1.4의 FlowMod 메시지, MeterMod 메시지 및 GroupMod 메시지
시험에 대응하고 있습니다.</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">시험 대상 메시지</th>
<th class="head">대응 매개변수</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>FlowMod 메시지</td>
<td><p class="first">match (IN_PHY_PORT 제외)</p>
<p class="last">actions (SET_QUEUE)</p>
</td>
</tr>
<tr class="row-odd"><td>MeterMod 메시지</td>
<td>모두</td>
</tr>
<tr class="row-even"><td>GroupMod 메시지</td>
<td>모두</td>
</tr>
</tbody>
</table>
<p>적용하는 패킷의 생성과 패킷 재 작성 결과의 확인 등은 「 <a class="reference internal" href="packet_lib.html#ch-packet-lib"><em>패킷 라이브러리</em></a> 」 를 사용하고 있습니다.</p>
<div class="section" id="id2">
<h3>시험 실행 이미지<a class="headerlink" href="#id2" title="제목 주소">¶</a></h3>
<p>테스트 도구를 실행했을 때의 동작 이미지를 보여줍니다. 테스트 패턴 파일
에는 「적용 플로우 항목 또는 미터 항목」,  「적용 패킷」,
「기대하는 처리 결과」가 설명됩니다. 또한 도구 실행을 위한 환경 설정
내용은 뒤에 설명합니다 (<a class="reference internal" href="#id5">도구 실행 환경</a> 참조).</p>
<a class="reference internal image-reference" href="_images/fig18.png"><img alt="_images/fig18.png" class="align-center" src="_images/fig18.png" /></a>
</div>
<div class="section" id="id3">
<h3>시험 결과의 출력 이미지<a class="headerlink" href="#id3" title="제목 주소">¶</a></h3>
<p>지정된 테스트 패턴 테스트 항목을 순서대로 수행하고 시험 결과
(OK/ERROR)를 출력합니다. 시험 결과가 ERROR인 경우 오류 정보를 함께 출력합니다.
또한 시험 전체의 OK/ERROR 개수 및 발생한 ERROR 내역도 출력합니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>--- Test start ---

match: 29_ICMPV6_TYPE
    ethernet/ipv6/icmpv6(type=128)--&gt;&#39;icmpv6_type=128,actions=output:2&#39;               OK
    ethernet/ipv6/icmpv6(type=128)--&gt;&#39;icmpv6_type=128,actions=output:CONTROLLER&#39;      OK
    ethernet/ipv6/icmpv6(type=135)--&gt;&#39;icmpv6_type=128,actions=output:2&#39;               OK
    ethernet/vlan/ipv6/icmpv6(type=128)--&gt;&#39;icmpv6_type=128,actions=output:2&#39;          ERROR
        Received incorrect packet-in: ethernet(ethertype=34525)
    ethernet/vlan/ipv6/icmpv6(type=128)--&gt;&#39;icmpv6_type=128,actions=output:CONTROLLER&#39; ERROR
        Received incorrect packet-in: ethernet(ethertype=34525)
match: 30_ICMPV6_CODE
    ethernet/ipv6/icmpv6(code=0)--&gt;&#39;icmpv6_code=0,actions=output:2&#39;                   OK
    ethernet/ipv6/icmpv6(code=0)--&gt;&#39;icmpv6_code=0,actions=output:CONTROLLER&#39;          OK
    ethernet/ipv6/icmpv6(code=1)--&gt;&#39;icmpv6_code=0,actions=output:2&#39;                   OK
    ethernet/vlan/ipv6/icmpv6(code=0)--&gt;&#39;icmpv6_code=0,actions=output:2&#39;              ERROR
        Received incorrect packet-in: ethernet(ethertype=34525)
    ethernet/vlan/ipv6/icmpv6(code=0)--&gt;&#39;icmpv6_code=0,actions=output:CONTROLLER&#39;     ERROR
        Received incorrect packet-in: ethernet(ethertype=34525)

---  Test end  ---

--- Test report ---
Received incorrect packet-in(4)
    match: 29_ICMPV6_TYPE                    ethernet/vlan/ipv6/icmpv6(type=128)--&gt;&#39;icmpv6_type=128,actions=output:2&#39;
    match: 29_ICMPV6_TYPE                    ethernet/vlan/ipv6/icmpv6(type=128)--&gt;&#39;icmpv6_type=128,actions=output:CONTROLLER&#39;
    match: 30_ICMPV6_CODE                    ethernet/vlan/ipv6/icmpv6(code=0)--&gt;&#39;icmpv6_code=0,actions=output:2&#39;
    match: 30_ICMPV6_CODE                    ethernet/vlan/ipv6/icmpv6(code=0)--&gt;&#39;icmpv6_code=0,actions=output:CONTROLLER&#39;

OK(6) / ERROR(4)
</pre></div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>사용 방법<a class="headerlink" href="#id4" title="제목 주소">¶</a></h2>
<p>테스트 도구의 사용 방법을 설명합니다.</p>
<div class="section" id="id5">
<h3>도구 실행 환경<a class="headerlink" href="#id5" title="제목 주소">¶</a></h3>
<p>테스트 도구 실행을 위한 환경은 다음과 같습니다.</p>
<a class="reference internal image-reference" href="_images/fig25.png"><img alt="_images/fig25.png" class="align-center" src="_images/fig25.png" /></a>
<p>보조 스위치로 다음 동작을 완료 할 수 있는 OpenFlow 스위치가 필요합니다.</p>
<ul class="simple">
<li>actions=CONTROLLER의 플로우 항목 등록</li>
<li>처리량 측정을위한 플로우 항목 등록</li>
<li>actions=CONTROLLER의 플로우 항목에 의한 Packet-In 메시지 보내기</li>
<li>Packet-Out 메시지 수신에 의한 패킷 전송</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">주석</p>
<p>Open vSwitch를 시험 대상 스위치로 하는 도구 실행 환경을 mininet에서 실현한
환경 구축 스크립트가 Ryu 소스 트리에 포함되어 있습니다.</p>
<blockquote>
<div>ryu/tests/switch/run_mininet.py</div></blockquote>
<p class="last">스크립트 예제는 「 <a class="reference internal" href="#id7">테스트 도구 사용 예</a> 」에 기재되어 있습니다.</p>
</div>
</div>
<div class="section" id="id6">
<h3>테스트 도구 실행 환경<a class="headerlink" href="#id6" title="제목 주소">¶</a></h3>
<p>테스트 도구 Ryu 소스 트리에 게시되어 있습니다.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">소스 코드</th>
<th class="head">설명</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ryu/tests/switch/tester.py</td>
<td>테스트 도구</td>
</tr>
<tr class="row-odd"><td>ryu/tests/switch/of13</td>
<td>테스트 패턴 샘플(OpenFlow 1.3용)</td>
</tr>
<tr class="row-even"><td>ryu/tests/switch/of14</td>
<td>테스트 패턴 샘플(OpenFlow 1.4용)</td>
</tr>
<tr class="row-odd"><td>ryu/tests/switch/run_mininet.py</td>
<td>시험 환경 구축 스크립트</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>테스트 도구는 다음 명령을 실행합니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>$ ryu-manager [--test-switch-target DPID] [--test-switch-tester DPID]
 [--test-switch-target-version VERSION] [--test-switch-tester-version VERSION]
 [--test-switch-dir DIRECTORY] ryu/tests/switch/tester.py
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="43%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">옵션</th>
<th class="head">설명</th>
<th class="head">기본값</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">--test-switch-target</span></tt></td>
<td>시험 대상 스위치의 데이터 경로 ID</td>
<td>0000000000000001</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">--test-switch-tester</span></tt></td>
<td>보조 스위치의 데이터 경로 ID</td>
<td>0000000000000002</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">--test-switch-target-version</span></tt></td>
<td>시험 대상 스위치의 OpenFlow 버전
(&#8220;openflow13&#8221;,&#8221;openflow14&#8221; 지정 가능)</td>
<td>openflow13</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">--test-switch-tester-version</span></tt></td>
<td>보조 스위치의 OpenFlow 버전
(&#8220;openflow13&#8221;,&#8221;openflow14&#8221; 지정 가능)</td>
<td>openflow13</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">--test-switch-dir</span></tt></td>
<td>테스트 패턴 파일의 디렉토리 경로</td>
<td>ryu/tests/switch/of13</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">주석</p>
<p class="last">테스트 도구 Ryu 응용 프로그램은 ryu.base.app_manager.RyuApp을
상속하여 만들었기 때문에, 다른 Ryu 응용 프로그램과 마찬가지로 &#8211;verbose
옵션으로 디버깅 정보 출력 등을 지원합니다.</p>
</div>
<p>테스트 도구를 시작한 후 시험 대상 스위치와 보조 스위치 컨트롤러에
연결되면 지정된 테스트 패턴을 바탕으로 시험이 시작됩니다.
연결된 스위치 OpenFlow 버전이 지정한 OpenFlow 버전과 다른 경우에는
관련 메시지가 표시되고 올바른 버전의 연결을 기다립니다.</p>
</div>
</div>
<div class="section" id="id7">
<h2>테스트 도구 사용 예<a class="headerlink" href="#id7" title="제목 주소">¶</a></h2>
<p>샘플 테스트 패턴과 원본 테스트 패턴을 이용한 테스트 도구의 실행 단계를 소개합니다.</p>
<div class="section" id="id8">
<h3>샘플 테스트 패턴의 실행 단계<a class="headerlink" href="#id8" title="제목 주소">¶</a></h3>
<p>Ryu 소스 트리의 샘플 테스트 패턴 (ryu/tests/switch/of13)을 이용한
테스트 도구 실행 단계를 보여줍니다.</p>
<div class="admonition note">
<p class="first admonition-title">주석</p>
<p>Ryu 소스 트리에는 샘플 테스트 패턴으로 FlowMod 메시지에 대해
match/actions로 지정 가능한 각 매개 변수 및 MeterMod 메시지의
각 파라미터나 GroupMod 메시지의 각 파라미터가 각각 정상적으로 작동하는지
확인하는 테스트 패턴 파일이 OpenFlow 1.3용과 OpenFlow 1.4용으로
준비되어 있습니다.</p>
<blockquote class="last">
<div><p>ryu/tests/switch/of13</p>
<p>ryu/tests/switch/of14</p>
</div></blockquote>
</div>
<p>이 단계에서는 시험 환경 구축 스크립트 (ryu/tests/switch/run_mininet.py)
를 이용하여 구축합니다. 따라서 시험 대상 스위치는 Open vSwitch입니다.
VM 이미지 사용을 위한 환경 설정 및 로그인 방법 등은 「 <a class="reference internal" href="switching_hub.html#ch-switching-hub"><em>스위칭 허브</em></a> 」
을 참조하십시오.</p>
<ol class="arabic">
<li><p class="first">시험 환경 구축</p>
<blockquote>
<div><p>VM 환경에 로그인하고 시험 환경 구축 스크립트를 실행합니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>ryu@ryu-vm:~$ sudo ryu/ryu/tests/switch/run_mininet.py
</pre></div>
</div>
<p>net 명령의 실행 결과는 다음과 같습니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>mininet&gt; net
c0
s1 lo:  s1-eth1:s2-eth1 s1-eth2:s2-eth2 s1-eth3:s2-eth3
s2 lo:  s2-eth1:s1-eth1 s2-eth2:s1-eth2 s2-eth3:s1-eth3
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">테스트 도구 실행</p>
<blockquote>
<div><p>테스트 도구 실행을 위한 컨트롤러의 xterm을 엽니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>mininet&gt; xterm c0
</pre></div>
</div>
<p>「Node: c0 (root)」의 xterm에서 테스트 도구를 실행합니다.
이때 테스트 패턴 파일 디렉토리로
샘플 테스트 패턴의 디렉토리 (ryu/tests/switch/of13)을 지정합니다.
또한 mininet 환경 시험 대상 스위치와 보조 스위치의 데이터 경로 ID는 각각
&#8211;test-switch-target/&#8211;test-switch-tester 옵션 기본값으로
되어 있기 때문에 옵션을 생략합니다. 또한 시험 대상 스위치와
보조 스위치 OpenFlow 버전은 각각 &#8211;test-switch-target-version /
&#8211;test-switch-tester-version 옵션의 기본값으로 되어 있기 때문에
해당 옵션 또한 생략합니다.</p>
<p>Node: c0:</p>
<div class="console highlight-python"><div class="highlight"><pre>root@ryu-vm:~$ ryu-manager --test-switch-dir ryu/ryu/tests/switch/of13 ryu/ryu/tests/switch/tester.py
</pre></div>
</div>
<p>도구를 실행하면 다음과 같이 표시되고 시험되는 스위치와 보조 스위치가
컨트롤러에 연결될 때까지 기다립니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>root@ryu-vm:~$ ryu-manager --test-switch-dir ryu/ryu/tests/switch/of13/ ryu/ryu/tests/switch/tester.py
loading app ryu/ryu/tests/switch/tester.py
loading app ryu.controller.ofp_handler
instantiating app ryu/ryu/tests/switch/tester.py of OfTester
target_dpid=0000000000000001
tester_dpid=0000000000000002
Test files directory = ryu/ryu/tests/switch/of13/
instantiating app ryu.controller.ofp_handler of OFPHandler
--- Test start ---
waiting for switches connection...
</pre></div>
</div>
<p>시험 대상 스위치와 보조 스위치가 컨트롤러에 연결되면
시험이 시작됩니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>root@ryu-vm:~$ ryu-manager --test-switch-dir ryu/ryu/tests/switch/of13/ ryu/ryu/tests/switch/tester.py
loading app ryu/ryu/tests/switch/tester.py
loading app ryu.controller.ofp_handler
instantiating app ryu/ryu/tests/switch/tester.py of OfTester
target_dpid=0000000000000001
tester_dpid=0000000000000002
Test files directory = ryu/ryu/tests/switch/of13/
instantiating app ryu.controller.ofp_handler of OFPHandler
--- Test start ---
waiting for switches connection...
dpid=0000000000000002 : Join tester SW.
dpid=0000000000000001 : Join target SW.
action: 00_OUTPUT
    ethernet/ipv4/tcp--&gt;&#39;actions=output:2&#39;      OK
    ethernet/ipv6/tcp--&gt;&#39;actions=output:2&#39;      OK
    ethernet/arp--&gt;&#39;actions=output:2&#39;           OK
action: 11_COPY_TTL_OUT
    ethernet/mpls(ttl=64)/ipv4(ttl=32)/tcp--&gt;&#39;eth_type=0x8847,actions=copy_ttl_out,output:2&#39;        ERROR
        Failed to add flows: OFPErrorMsg[type=0x02, code=0x00]
    ethernet/mpls(ttl=64)/ipv6(hop_limit=32)/tcp--&gt;&#39;eth_type=0x8847,actions=copy_ttl_out,output:2&#39;  ERROR
        Failed to add flows: OFPErrorMsg[type=0x02, code=0x00]
...
</pre></div>
</div>
<p>ryu/tests/switch/of13 부하의 모든 샘플 테스트 패턴의 시험이
완료되면 테스트 도구는 종료됩니다.</p>
</div></blockquote>
</li>
</ol>
<div class="section" id="id9">
<h4>&lt;참고&gt;샘플 테스트 패턴 파일 목록<a class="headerlink" href="#id9" title="제목 주소">¶</a></h4>
<blockquote>
<div><blockquote>
<div><p>match／actions의 각 설정 항목에 해당하는 플로우 항목을 등록하고
플로우 항목에 match하는 (또는 match하지 않는) 여러 패턴의 패킷을
적용하는 테스트 패턴과 일정 빈도 이상에 대해 삭제 또는
우선 순위를 변경할 미터 항목을 등록하고 미터 항목에 match
패킷을 연속적으로 적용하는 테스트 패턴 및 모든 포트에 FLOODING하는
type=ALL인 그룹 항목과 분류 조건에 따라 출력 포트를 자동으로
변경하는 type=SELECT인 그룹 항목을 등록하여 그룹 항목에
match 패킷을 연속적으로 적용하는 테스트 패턴이 OpenFlow 1.3용과
OpenFlow 1.4용으로 각각 준비되어 있습니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>ryu/tests/switch/of13/action:
00_OUTPUT.json              20_POP_MPLS.json
11_COPY_TTL_OUT.json        23_SET_NW_TTL_IPv4.json
12_COPY_TTL_IN.json         23_SET_NW_TTL_IPv6.json
15_SET_MPLS_TTL.json        24_DEC_NW_TTL_IPv4.json
16_DEC_MPLS_TTL.json        24_DEC_NW_TTL_IPv6.json
17_PUSH_VLAN.json           25_SET_FIELD
17_PUSH_VLAN_multiple.json  26_PUSH_PBB.json
18_POP_VLAN.json            26_PUSH_PBB_multiple.json
19_PUSH_MPLS.json           27_POP_PBB.json
19_PUSH_MPLS_multiple.json

ryu/tests/switch/of13/action/25_SET_FIELD:
03_ETH_DST.json        14_TCP_DST_IPv4.json   24_ARP_SHA.json
04_ETH_SRC.json        14_TCP_DST_IPv6.json   25_ARP_THA.json
05_ETH_TYPE.json       15_UDP_SRC_IPv4.json   26_IPV6_SRC.json
06_VLAN_VID.json       15_UDP_SRC_IPv6.json   27_IPV6_DST.json
07_VLAN_PCP.json       16_UDP_DST_IPv4.json   28_IPV6_FLABEL.json
08_IP_DSCP_IPv4.json   16_UDP_DST_IPv6.json   29_ICMPV6_TYPE.json
08_IP_DSCP_IPv6.json   17_SCTP_SRC_IPv4.json  30_ICMPV6_CODE.json
09_IP_ECN_IPv4.json    17_SCTP_SRC_IPv6.json  31_IPV6_ND_TARGET.json
09_IP_ECN_IPv6.json    18_SCTP_DST_IPv4.json  32_IPV6_ND_SLL.json
10_IP_PROTO_IPv4.json  18_SCTP_DST_IPv6.json  33_IPV6_ND_TLL.json
10_IP_PROTO_IPv6.json  19_ICMPV4_TYPE.json    34_MPLS_LABEL.json
11_IPV4_SRC.json       20_ICMPV4_CODE.json    35_MPLS_TC.json
12_IPV4_DST.json       21_ARP_OP.json         36_MPLS_BOS.json
13_TCP_SRC_IPv4.json   22_ARP_SPA.json        37_PBB_ISID.json
13_TCP_SRC_IPv6.json   23_ARP_TPA.json        38_TUNNEL_ID.json

ryu/tests/switch/of13/group:
00_ALL.json           01_SELECT_IP.json            01_SELECT_Weight_IP.json
01_SELECT_Ether.json  01_SELECT_Weight_Ether.json

ryu/tests/switch/of13/match:
00_IN_PORT.json        13_TCP_SRC_IPv6.json   26_IPV6_SRC.json
02_METADATA.json       14_TCP_DST_IPv4.json   26_IPV6_SRC_Mask.json
02_METADATA_Mask.json  14_TCP_DST_IPv6.json   27_IPV6_DST.json
03_ETH_DST.json        15_UDP_SRC_IPv4.json   27_IPV6_DST_Mask.json
03_ETH_DST_Mask.json   15_UDP_SRC_IPv6.json   28_IPV6_FLABEL.json
04_ETH_SRC.json        16_UDP_DST_IPv4.json   28_IPV6_FLABEL_Mask.json
04_ETH_SRC_Mask.json   16_UDP_DST_IPv6.json   29_ICMPV6_TYPE.json
05_ETH_TYPE.json       17_SCTP_SRC_IPv4.json  30_ICMPV6_CODE.json
06_VLAN_VID.json       17_SCTP_SRC_IPv6.json  31_IPV6_ND_TARGET.json
06_VLAN_VID_Mask.json  18_SCTP_DST_IPv4.json  32_IPV6_ND_SLL.json
07_VLAN_PCP.json       18_SCTP_DST_IPv6.json  33_IPV6_ND_TLL.json
08_IP_DSCP_IPv4.json   19_ICMPV4_TYPE.json    34_MPLS_LABEL.json
08_IP_DSCP_IPv6.json   20_ICMPV4_CODE.json    35_MPLS_TC.json
09_IP_ECN_IPv4.json    21_ARP_OP.json         36_MPLS_BOS.json
09_IP_ECN_IPv6.json    22_ARP_SPA.json        37_PBB_ISID.json
10_IP_PROTO_IPv4.json  22_ARP_SPA_Mask.json   37_PBB_ISID_Mask.json
10_IP_PROTO_IPv6.json  23_ARP_TPA.json        38_TUNNEL_ID.json
11_IPV4_SRC.json       23_ARP_TPA_Mask.json   38_TUNNEL_ID_Mask.json
11_IPV4_SRC_Mask.json  24_ARP_SHA.json        39_IPV6_EXTHDR.json
12_IPV4_DST.json       24_ARP_SHA_Mask.json   39_IPV6_EXTHDR_Mask.json
12_IPV4_DST_Mask.json  25_ARP_THA.json
13_TCP_SRC_IPv4.json   25_ARP_THA_Mask.json

ryu/tests/switch/of13/meter:
01_DROP_00_KBPS_00_1M.json      02_DSCP_REMARK_00_KBPS_00_1M.json
01_DROP_00_KBPS_01_10M.json     02_DSCP_REMARK_00_KBPS_01_10M.json
01_DROP_00_KBPS_02_100M.json    02_DSCP_REMARK_00_KBPS_02_100M.json
01_DROP_01_PKTPS_00_100.json    02_DSCP_REMARK_01_PKTPS_00_100.json
01_DROP_01_PKTPS_01_1000.json   02_DSCP_REMARK_01_PKTPS_01_1000.json
01_DROP_01_PKTPS_02_10000.json  02_DSCP_REMARK_01_PKTPS_02_10000.json
</pre></div>
</div>
</div></blockquote>
<div class="console highlight-python"><div class="highlight"><pre>ryu/tests/switch/of14/action:
00_OUTPUT.json              20_POP_MPLS.json
11_COPY_TTL_OUT.json        23_SET_NW_TTL_IPv4.json
12_COPY_TTL_IN.json         23_SET_NW_TTL_IPv6.json
15_SET_MPLS_TTL.json        24_DEC_NW_TTL_IPv4.json
16_DEC_MPLS_TTL.json        24_DEC_NW_TTL_IPv6.json
17_PUSH_VLAN.json           25_SET_FIELD
17_PUSH_VLAN_multiple.json  26_PUSH_PBB.json
18_POP_VLAN.json            26_PUSH_PBB_multiple.json
19_PUSH_MPLS.json           27_POP_PBB.json
19_PUSH_MPLS_multiple.json

ryu/tests/switch/of14/action/25_SET_FIELD:
03_ETH_DST.json        14_TCP_DST_IPv6.json   26_IPV6_SRC.json
04_ETH_SRC.json        15_UDP_SRC_IPv4.json   27_IPV6_DST.json
05_ETH_TYPE.json       15_UDP_SRC_IPv6.json   28_IPV6_FLABEL.json
06_VLAN_VID.json       16_UDP_DST_IPv4.json   29_ICMPV6_TYPE.json
07_VLAN_PCP.json       16_UDP_DST_IPv6.json   30_ICMPV6_CODE.json
08_IP_DSCP_IPv4.json   17_SCTP_SRC_IPv4.json  31_IPV6_ND_TARGET.json
08_IP_DSCP_IPv6.json   17_SCTP_SRC_IPv6.json  32_IPV6_ND_SLL.json
09_IP_ECN_IPv4.json    18_SCTP_DST_IPv4.json  33_IPV6_ND_TLL.json
09_IP_ECN_IPv6.json    18_SCTP_DST_IPv6.json  34_MPLS_LABEL.json
10_IP_PROTO_IPv4.json  19_ICMPV4_TYPE.json    35_MPLS_TC.json
10_IP_PROTO_IPv6.json  20_ICMPV4_CODE.json    36_MPLS_BOS.json
11_IPV4_SRC.json       21_ARP_OP.json         37_PBB_ISID.json
12_IPV4_DST.json       22_ARP_SPA.json        38_TUNNEL_ID.json
13_TCP_SRC_IPv4.json   23_ARP_TPA.json        41_PBB_UCA.json
13_TCP_SRC_IPv6.json   24_ARP_SHA.json
14_TCP_DST_IPv4.json   25_ARP_THA.json

ryu/tests/switch/of14/group:
00_ALL.json           01_SELECT_IP.json            01_SELECT_Weight_IP.json
01_SELECT_Ether.json  01_SELECT_Weight_Ether.json

ryu/tests/switch/of14/match:
00_IN_PORT.json        13_TCP_SRC_IPv6.json   26_IPV6_SRC.json
02_METADATA.json       14_TCP_DST_IPv4.json   26_IPV6_SRC_Mask.json
02_METADATA_Mask.json  14_TCP_DST_IPv6.json   27_IPV6_DST.json
03_ETH_DST.json        15_UDP_SRC_IPv4.json   27_IPV6_DST_Mask.json
03_ETH_DST_Mask.json   15_UDP_SRC_IPv6.json   28_IPV6_FLABEL.json
04_ETH_SRC.json        16_UDP_DST_IPv4.json   28_IPV6_FLABEL_Mask.json
04_ETH_SRC_Mask.json   16_UDP_DST_IPv6.json   29_ICMPV6_TYPE.json
05_ETH_TYPE.json       17_SCTP_SRC_IPv4.json  30_ICMPV6_CODE.json
06_VLAN_VID.json       17_SCTP_SRC_IPv6.json  31_IPV6_ND_TARGET.json
06_VLAN_VID_Mask.json  18_SCTP_DST_IPv4.json  32_IPV6_ND_SLL.json
07_VLAN_PCP.json       18_SCTP_DST_IPv6.json  33_IPV6_ND_TLL.json
08_IP_DSCP_IPv4.json   19_ICMPV4_TYPE.json    34_MPLS_LABEL.json
08_IP_DSCP_IPv6.json   20_ICMPV4_CODE.json    35_MPLS_TC.json
09_IP_ECN_IPv4.json    21_ARP_OP.json         36_MPLS_BOS.json
09_IP_ECN_IPv6.json    22_ARP_SPA.json        37_PBB_ISID.json
10_IP_PROTO_IPv4.json  22_ARP_SPA_Mask.json   37_PBB_ISID_Mask.json
10_IP_PROTO_IPv6.json  23_ARP_TPA.json        38_TUNNEL_ID.json
11_IPV4_SRC.json       23_ARP_TPA_Mask.json   38_TUNNEL_ID_Mask.json
11_IPV4_SRC_Mask.json  24_ARP_SHA.json        39_IPV6_EXTHDR.json
12_IPV4_DST.json       24_ARP_SHA_Mask.json   39_IPV6_EXTHDR_Mask.json
12_IPV4_DST_Mask.json  25_ARP_THA.json        41_PBB_UCA.json
13_TCP_SRC_IPv4.json   25_ARP_THA_Mask.json

ryu/tests/switch/of14/meter:
01_DROP_00_KBPS_00_1M.json      02_DSCP_REMARK_00_KBPS_00_1M.json
01_DROP_00_KBPS_01_10M.json     02_DSCP_REMARK_00_KBPS_01_10M.json
01_DROP_00_KBPS_02_100M.json    02_DSCP_REMARK_00_KBPS_02_100M.json
01_DROP_01_PKTPS_00_100.json    02_DSCP_REMARK_01_PKTPS_00_100.json
01_DROP_01_PKTPS_01_1000.json   02_DSCP_REMARK_01_PKTPS_01_1000.json
01_DROP_01_PKTPS_02_10000.json  02_DSCP_REMARK_01_PKTPS_02_10000.json
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="id10">
<h3>기존 테스트 패턴의 실행 단계<a class="headerlink" href="#id10" title="제목 주소">¶</a></h3>
<p>원본 테스트 패턴을 만들고 테스트 도구를 실행하는 방법을 설명합니다.</p>
<p>예를 들어, OpenFlow 스위치가 라우터 기능을 실현하기 위해 필요한 match / actions을
처리하는 기능을 가지고 있는지 확인하는 테스트 패턴을 만듭니다.</p>
<p>1．테스트 패턴 생성</p>
<blockquote>
<div><p>라우터가 라우팅 테이블에 따라 패킷을 전송하는 기능을 제공하는
다음 플로우 항목이 제대로 작동하는지 시험합니다.</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">match</th>
<th class="head">actions</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>대상IP주소 범위 「192.168.30.0/24」</td>
<td><p class="first">원본 MAC주소를 「aa:aa:aa:aa:aa:aa」로 수정</p>
<p>대상 MAC주소를 「bb:bb:bb:bb:bb:bb」로 수정</p>
<p>TTL 빼기</p>
<p class="last">패킷 전송</p>
</td>
</tr>
</tbody>
</table>
<p>이 테스트 패턴을 실행하는 테스트 패턴 파일을 만듭니다.</p>
<p>작성 예는 다음과 같습니다.</p>
<div class="admonition note">
<p class="first admonition-title">주석</p>
<p class="last">테스트 패턴 파일의 구체적인 작성 방법은 「 <a class="reference internal" href="#id11">테스트 패턴 파일 작성 방법</a> 」을 참고하시기 바랍니다.</p>
</div>
</div></blockquote>
<p>파일 이름： <tt class="docutils literal"><span class="pre">sample_test_pattern.json</span></tt></p>
<div class="sourcecode highlight-python"><div class="highlight"><pre><span class="p">[</span>
   <span class="s">&quot;sample: Router test&quot;</span><span class="p">,</span>
   <span class="p">{</span>
       <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;static routing table&quot;</span><span class="p">,</span>
       <span class="s">&quot;prerequisite&quot;</span><span class="p">:</span> <span class="p">[</span>
           <span class="p">{</span>
               <span class="s">&quot;OFPFlowMod&quot;</span><span class="p">:</span> <span class="p">{</span>
                   <span class="s">&quot;table_id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="p">{</span>
                       <span class="s">&quot;OFPMatch&quot;</span><span class="p">:</span> <span class="p">{</span>
                           <span class="s">&quot;oxm_fields&quot;</span><span class="p">:</span> <span class="p">[</span>
                               <span class="p">{</span>
                                   <span class="s">&quot;OXMTlv&quot;</span><span class="p">:</span> <span class="p">{</span>
                                       <span class="s">&quot;field&quot;</span><span class="p">:</span> <span class="s">&quot;eth_type&quot;</span><span class="p">,</span>
                                       <span class="s">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2048</span>
                                   <span class="p">}</span>
                               <span class="p">},</span>
                               <span class="p">{</span>
                                   <span class="s">&quot;OXMTlv&quot;</span><span class="p">:</span> <span class="p">{</span>
                                       <span class="s">&quot;field&quot;</span><span class="p">:</span> <span class="s">&quot;ipv4_dst&quot;</span><span class="p">,</span>
                                       <span class="s">&quot;mask&quot;</span><span class="p">:</span> <span class="mi">4294967040</span><span class="p">,</span>
                                       <span class="s">&quot;value&quot;</span><span class="p">:</span> <span class="s">&quot;192.168.30.0&quot;</span>
                                   <span class="p">}</span>
                               <span class="p">}</span>
                          <span class="p">]</span>
                       <span class="p">}</span>
                   <span class="p">},</span>
                   <span class="s">&quot;instructions&quot;</span><span class="p">:[</span>
                       <span class="p">{</span>
                           <span class="s">&quot;OFPInstructionActions&quot;</span><span class="p">:</span> <span class="p">{</span>
                               <span class="s">&quot;actions&quot;</span><span class="p">:[</span>
                                   <span class="p">{</span>
                                       <span class="s">&quot;OFPActionSetField&quot;</span><span class="p">:{</span>
                                           <span class="s">&quot;field&quot;</span><span class="p">:{</span>
                                               <span class="s">&quot;OXMTlv&quot;</span><span class="p">:{</span>
                                                   <span class="s">&quot;field&quot;</span><span class="p">:</span><span class="s">&quot;eth_src&quot;</span><span class="p">,</span>
                                                   <span class="s">&quot;value&quot;</span><span class="p">:</span><span class="s">&quot;aa:aa:aa:aa:aa:aa&quot;</span>
                                               <span class="p">}</span>
                                           <span class="p">}</span>
                                       <span class="p">}</span>
                                   <span class="p">},</span>
                                   <span class="p">{</span>
                                       <span class="s">&quot;OFPActionSetField&quot;</span><span class="p">:{</span>
                                           <span class="s">&quot;field&quot;</span><span class="p">:{</span>
                                               <span class="s">&quot;OXMTlv&quot;</span><span class="p">:{</span>
                                                   <span class="s">&quot;field&quot;</span><span class="p">:</span><span class="s">&quot;eth_dst&quot;</span><span class="p">,</span>
                                                   <span class="s">&quot;value&quot;</span><span class="p">:</span><span class="s">&quot;bb:bb:bb:bb:bb:bb&quot;</span>
                                               <span class="p">}</span>
                                           <span class="p">}</span>
                                       <span class="p">}</span>
                                   <span class="p">},</span>
                                   <span class="p">{</span>
                                       <span class="s">&quot;OFPActionDecNwTtl&quot;</span><span class="p">:{}</span>
                                   <span class="p">},</span>
                                   <span class="p">{</span>
                                       <span class="s">&quot;OFPActionOutput&quot;</span><span class="p">:</span> <span class="p">{</span>
                                           <span class="s">&quot;port&quot;</span><span class="p">:</span><span class="mi">2</span>
                                       <span class="p">}</span>
                                   <span class="p">}</span>
                               <span class="p">],</span>
                               <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="mi">4</span>
                           <span class="p">}</span>
                       <span class="p">}</span>
                   <span class="p">]</span>
               <span class="p">}</span>
           <span class="p">}</span>
       <span class="p">],</span>
       <span class="s">&quot;tests&quot;</span><span class="p">:[</span>
           <span class="p">{</span>
               <span class="s">&quot;ingress&quot;</span><span class="p">:[</span>
                   <span class="s">&quot;ethernet(dst=&#39;22:22:22:22:22:22&#39;,src=&#39;11:11:11:11:11:11&#39;,ethertype=2048)&quot;</span><span class="p">,</span>
                   <span class="s">&quot;ipv4(tos=32, proto=6, src=&#39;192.168.10.10&#39;, dst=&#39;192.168.30.10&#39;, ttl=64)&quot;</span><span class="p">,</span>
                   <span class="s">&quot;tcp(dst_port=2222, option=&#39;</span><span class="se">\\</span><span class="s">x00</span><span class="se">\\</span><span class="s">x00</span><span class="se">\\</span><span class="s">x00</span><span class="se">\\</span><span class="s">x00&#39;, src_port=11111)&quot;</span><span class="p">,</span>
                   <span class="s">&quot;&#39;</span><span class="se">\\</span><span class="s">x01</span><span class="se">\\</span><span class="s">x02</span><span class="se">\\</span><span class="s">x03</span><span class="se">\\</span><span class="s">x04</span><span class="se">\\</span><span class="s">x05</span><span class="se">\\</span><span class="s">x06</span><span class="se">\\</span><span class="s">x07</span><span class="se">\\</span><span class="s">x08</span><span class="se">\\</span><span class="s">t</span><span class="se">\\</span><span class="s">n</span><span class="se">\\</span><span class="s">x0b</span><span class="se">\\</span><span class="s">x0c</span><span class="se">\\</span><span class="s">r</span><span class="se">\\</span><span class="s">x0e</span><span class="se">\\</span><span class="s">x0f&#39;&quot;</span>
               <span class="p">],</span>
               <span class="s">&quot;egress&quot;</span><span class="p">:[</span>
                   <span class="s">&quot;ethernet(dst=&#39;bb:bb:bb:bb:bb:bb&#39;,src=&#39;aa:aa:aa:aa:aa:aa&#39;,ethertype=2048)&quot;</span><span class="p">,</span>
                   <span class="s">&quot;ipv4(tos=32, proto=6, src=&#39;192.168.10.10&#39;, dst=&#39;192.168.30.10&#39;, ttl=63)&quot;</span><span class="p">,</span>
                   <span class="s">&quot;tcp(dst_port=2222, option=&#39;</span><span class="se">\\</span><span class="s">x00</span><span class="se">\\</span><span class="s">x00</span><span class="se">\\</span><span class="s">x00</span><span class="se">\\</span><span class="s">x00&#39;, src_port=11111)&quot;</span><span class="p">,</span>
                   <span class="s">&quot;&#39;</span><span class="se">\\</span><span class="s">x01</span><span class="se">\\</span><span class="s">x02</span><span class="se">\\</span><span class="s">x03</span><span class="se">\\</span><span class="s">x04</span><span class="se">\\</span><span class="s">x05</span><span class="se">\\</span><span class="s">x06</span><span class="se">\\</span><span class="s">x07</span><span class="se">\\</span><span class="s">x08</span><span class="se">\\</span><span class="s">t</span><span class="se">\\</span><span class="s">n</span><span class="se">\\</span><span class="s">x0b</span><span class="se">\\</span><span class="s">x0c</span><span class="se">\\</span><span class="s">r</span><span class="se">\\</span><span class="s">x0e</span><span class="se">\\</span><span class="s">x0f&#39;&quot;</span>
               <span class="p">]</span>
           <span class="p">}</span>
       <span class="p">]</span>
   <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>2．시험 환경 구축</p>
<blockquote>
<div>시험 환경 구축 스크립트를 사용하여 시험 환경을 구축합니다. 절차는
<a class="reference internal" href="#id8">샘플 테스트 패턴의 실행 단계</a> 을 참조하십시오.</div></blockquote>
<p>3．테스트 도구 실행</p>
<blockquote>
<div><p>컨트롤러 xterm에서 방금 만든 원래의 테스트 패턴 파일
를 지정하여 테스트 도구를 실행합니다.
또한, &#8211;test-switch-dir 옵션은 디렉토리뿐만 아니라 파일을 직접
지정할 수 있습니다. 또한 송수신 패킷의 내용을 확인하기 위해
&#8211;verbose 옵션을 지정합니다.</p>
<p>Node: c0:</p>
<div class="console highlight-python"><div class="highlight"><pre>root@ryu-vm:~$ ryu-manager --verbose --test-switch-dir ./sample_test_pattern.json ryu/ryu/tests/switch/tester.py
</pre></div>
</div>
<p>시험 대상 스위치와 보조 스위치가 컨트롤러에 연결되면 시험이
시작됩니다.</p>
<p>「dpid=0000000000000002 : receive_packet...」로깅에서 테스트
패턴 파일 egress 패킷으로 설정한 예상 출력 패킷이
전송된 것을 알 수 있습니다.
또한, 여기에서는 테스트 도구가 출력한 로그만을 발췌하였습니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>root@ryu-vm:~$ ryu-manager --verbose --test-switch-dir ./sample_test_pattern.json ryu/ryu/tests/switch/tester.py
loading app ryu/tests/switch/tester.py
loading app ryu.controller.ofp_handler
instantiating app ryu.controller.ofp_handler of OFPHandler
instantiating app ryu/tests/switch/tester.py of OfTester
target_dpid=0000000000000001
tester_dpid=0000000000000002
Test files directory = ./sample_test_pattern.json

--- Test start ---
waiting for switches connection...

dpid=0000000000000002 : Join tester SW.
dpid=0000000000000001 : Join target SW.

sample: Router test

send_packet:[ethernet(dst=&#39;22:22:22:22:22:22&#39;,ethertype=2048,src=&#39;11:11:11:11:11:11&#39;), ipv4(csum=53560,dst=&#39;192.168.30.10&#39;,flags=0,header_length=5,identification=0,offset=0,option=None,proto=6,src=&#39;192.168.10.10&#39;,tos=32,total_length=59,ttl=64,version=4), tcp(ack=0,bits=0,csum=33311,dst_port=2222,offset=6,option=&#39;\x00\x00\x00\x00&#39;,seq=0,src_port=11111,urgent=0,window_size=0), &#39;\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f&#39;]
egress:[ethernet(dst=&#39;bb:bb:bb:bb:bb:bb&#39;,ethertype=2048,src=&#39;aa:aa:aa:aa:aa:aa&#39;), ipv4(csum=53816,dst=&#39;192.168.30.10&#39;,flags=0,header_length=5,identification=0,offset=0,option=None,proto=6,src=&#39;192.168.10.10&#39;,tos=32,total_length=59,ttl=63,version=4), tcp(ack=0,bits=0,csum=33311,dst_port=2222,offset=6,option=&#39;\x00\x00\x00\x00&#39;,seq=0,src_port=11111,urgent=0,window_size=0), &#39;\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f&#39;]
packet_in:[]
dpid=0000000000000002 : receive_packet[ethernet(dst=&#39;bb:bb:bb:bb:bb:bb&#39;,ethertype=2048,src=&#39;aa:aa:aa:aa:aa:aa&#39;), ipv4(csum=53816,dst=&#39;192.168.30.10&#39;,flags=0,header_length=5,identification=0,offset=0,option=None,proto=6,src=&#39;192.168.10.10&#39;,tos=32,total_length=59,ttl=63,version=4), tcp(ack=0,bits=0,csum=33311,dst_port=2222,offset=6,option=&#39;\x00\x00\x00\x00&#39;,seq=0,src_port=11111,urgent=0,window_size=0), &#39;\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f&#39;]
    static routing table                            OK
---  Test end  ---
</pre></div>
</div>
<p>실제로 OpenFlow 스위치에 등록된 플로우 항목은 다음과 같습니다.
테스트 도구에 의해 등록된 패킷 플로우 항목에 match하고
n_packets가 올라가는 것을 알 수 있습니다.</p>
<p>Node: s1:</p>
<div class="console highlight-python"><div class="highlight"><pre>root@ryu-vm:~# ovs-ofctl -O OpenFlow13 dump-flows s1
OFPST_FLOW reply (OF1.3) (xid=0x2):
 cookie=0x0, duration=56.217s, table=0, n_packets=1, n_bytes=73, priority=0,ip,nw_dst=192.168.30.0/24 actions=set_field:aa:aa:aa:aa:aa:aa-&gt;eth_src,set_field:bb:bb:bb:bb:bb:bb-&gt;eth_dst,dec_ttl,output:2
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="id11">
<h3>테스트 패턴 파일 작성 방법<a class="headerlink" href="#id11" title="제목 주소">¶</a></h3>
<p>테스트 패턴 파일 확장자는 「. json」에 해당하는 텍스트 파일입니다.
다음 형식과 같이 작성합니다.</p>
<div class="sourcecode highlight-python"><div class="highlight"><pre>[
    &quot;xxxxxxxxxx&quot;,                    # 시험 항목 이름
    {
        &quot;description&quot;: &quot;xxxxxxxxxx&quot;, # 시험 내용 설명
        &quot;prerequisite&quot;: [
            {
                &quot;OFPFlowMod&quot;: {...}  # 등록하는 플로우 항목, 미터 항목, 그룹 항목
            },                       # (Ryu의 OFPFlowMod, OFPMeterMod, OFPGroupMod를
            {                        #  json 형식으로 작성)
                &quot;OFPMeterMod&quot;: {...} #  플로우 항목에서 기대하는 처리 결과가
            },                       #  패킷 전송 (actions = output)의 경우
            {                        #  출력 포트 번호에 「2」를 지정하십시오
                &quot;OFPGroupMod&quot;: {...} #  그룹 항목에서 패킷 전송을 할 경우
            },                       #  출력 포트 번호는 「2」또는 「3」을
            {...}                    #  지정하십시오
        ],
        &quot;tests&quot;: [
            {
                # 적용 패킷
                # 1 번만 적용할지 일정 시간 연속하여 적용 계속 여부에 따라
                # (A)(B) 중 하나를 설명
                #  (A) 1번 적용
                &quot;ingress&quot;: [
                    &quot;ethernet(...)&quot;, # (Ryu 패킷 라이브러리 생성자의 형식으로 작성)
                    &quot;ipv4(...)&quot;,
                    &quot;tcp(...)&quot;
                ],
                #  (B) 일정 시간 연속 적용
                &quot;ingress&quot;: {
                    &quot;packets&quot;:{
                        &quot;data&quot;:[
                            &quot;ethernet(...)&quot;, # (A)와 동일
                            &quot;ipv4(...)&quot;,
                            &quot;tcp(...)&quot;
                        ],
                        &quot;pktps&quot;: 1000,       # 초당 적용하는 패킷 수를 지정
                        &quot;duration_time&quot;: 30  # 연속 적용 시간을 초 단위로 지정
                    }
                },

                # 기대할 처리 결과
                # 처리 결과의 종별에 따라 (a) (b) (c) (d) 중 하나를 설명
                # (a) 패킷 전송 (actions = output : X)의 확인 시험
                &quot;egress&quot;: [          # 기대할 전송 패킷
                    &quot;ethernet(...)&quot;,
                    &quot;ipv4(...)&quot;,
                    &quot;tcp(...)&quot;
                ]
                #  (b) 패킷 인 (actions = CONTROLLER)의 확인 시험
                &quot;PACKET_IN&quot;: [       # 기대할 Packet-In 데이터
                    &quot;ethernet(...)&quot;,
                    &quot;ipv4(...)&quot;,
                    &quot;tcp(...)&quot;
                ]
                #  (c) table-miss 확인 시험
                &quot;table-miss&quot;: [      # table-miss이되는 것을 기대하는 플로우 테이블 ID
                    0
                ]
                #  (d) 패킷 전송 (actions = output : X) 때 처리량의 확인 시험
                &quot;egress&quot;:[
                    &quot;throughput&quot;:[
                        {
                            &quot;OFPMatch&quot;:{   # 처리량 측정에
                              ...          # 보조 SW에 등록 된
                            },             # 플로우 항목 Match 조건
                            &quot;kbps&quot;:1000    # 예상 처리량을 Kbps 단위로 지정
                        },
                        {...},
                        {...}
                    ]
                ]
            },
            {...},
            {...}
        ]
    },                               # 시험1
    {...},                           # 시험2
    {...}                            # 시험3
]
</pre></div>
</div>
<p>적용 패킷으로 「(B) 일정 시간 연속 여부」를,
기대하는 처리 결과로 「(d) 패킷 전송 (actions = output : X) 때 처리량의 확인 시험」을
각각 작성하여 시험 대상 SW의 처리량을 측정할 수 있습니다.</p>
<p>테스트 패턴 파일에서 지정하는 입력 / 출력 포트 번호의 숫자에 대한 의미는 「 <a class="reference internal" href="#id12">＜참고＞적용 패킷의 전송 이미지</a> 」를 참고하십시오.</p>
<div class="section" id="id12">
<h4>＜참고＞적용 패킷의 전송 이미지<a class="headerlink" href="#id12" title="제목 주소">¶</a></h4>
<p>시험 대상 SW 및 보조 SW 포트는 다음 용도로 이용합니다.</p>
<a class="reference internal image-reference" href="_images/fig35.png"><img alt="_images/fig35.png" class="align-center" src="_images/fig35.png" /></a>
<p>Flow_mod 메시지 / Meter_mod 메시지 테스트를 수행하는 경우 적용 패킷의 전송 이미지는 다음과 같습니다.</p>
<ol class="arabic simple">
<li>보조 SW의 패킷 송신 포트 (포트 번호 1)에서 패킷 전송</li>
<li>시험 대상 SW의 패킷 수신 포트 (포트 번호 1)에서 패킷 수신</li>
<li>시험 대상 SW의 패킷 송신 포트 1 (포트 번호 2)에서 패킷 전송</li>
<li>보조 SW의 패킷 수신 포트 1 (포트 번호 2)에서 패킷을 수신</li>
</ol>
<a class="reference internal image-reference" href="_images/fig44.png"><img alt="_images/fig44.png" class="align-center" src="_images/fig44.png" /></a>
<p>Group_mod 메시지 테스트를 수행하는 경우 적용 패킷의 전송 이미지는 다음과 같습니다.</p>
<ol class="arabic simple">
<li>보조 SW의 패킷 송신 포트 (포트 번호 1)에서 패킷 전송</li>
<li>시험 대상 SW의 패킷 수신 포트 (포트 번호 1)에서 패킷 수신</li>
<li>시험 대상 SW의 패킷 송신 포트 1 (포트 번호 2) 또는 시험 대상 SW의 패킷 송신 포트 2 (포트 번호 3)에서 패킷 전송</li>
<li>보조 SW의 패킷 수신 포트 1 (포트 번호 2) 또는 보조 SW 패킷 수신 포트 2 (포트 번호 3)에서 패킷을 수신</li>
</ol>
<a class="reference internal image-reference" href="_images/fig53.png"><img alt="_images/fig53.png" class="align-center" src="_images/fig53.png" /></a>
<p>그림과 같이, Group_mod 테스트를 수행하는 경우에만 시험 대상 SW의 패킷 포트 2 및 보조 SW 패킷 수신 포트 2를 이용하는 경우가 있습니다.</p>
</div>
</div>
<div class="section" id="id13">
<h3>포트 번호 변경 방법<a class="headerlink" href="#id13" title="제목 주소">¶</a></h3>
<p>준비 환경에서 OpenFlow 스위치의 포트 번호가 「 <a class="reference internal" href="#id6">테스트 도구 실행 환경</a> 」과 다르면 테스트 도구 실행시 옵션을 지정하여 테스트에 사용할 포트 번호를 변경할 수 있습니다.</p>
<p>포트 번호를 변경하는 옵션은 다음과 같습니다.</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="50%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">옵션</th>
<th class="head">설명</th>
<th class="head">기본값</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">--test-switch-target_recv_port</span></tt></td>
<td>시험 대상 스위치에서 패킷 수신 포트의 포트 번호</td>
<td>1</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">--test-switch-target_send_port_1</span></tt></td>
<td>시험 대상 스위치에서 패킷 송신 포트 1의 포트 번호</td>
<td>2</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">--test-switch-target_send_port_2</span></tt></td>
<td>시험 대상 스위치에서 패킷 송신 포트 2의 포트 번호</td>
<td>3</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">--test-switch-tester_send_port</span></tt></td>
<td>보조 스위치에서 패킷 송신 포트의 포트 번호</td>
<td>1</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">--test-switch-tester_recv_port_1</span></tt></td>
<td>보조 스위치에서 패킷 수신 포트 1의 포트 번호</td>
<td>2</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">--test-switch-tester_recv_port_2</span></tt></td>
<td>보조 스위치에서 패킷 수신 포트 2의 포트 번호</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>이 옵션을 통해 포트 번호를 변경하는 경우, 테스트 패턴 파일에서 포트 번호 값 또한 변경해야 함을 유의하십시오.</p>
<div class="section" id="id14">
<h4>&lt;참고&gt;테스트 패턴 파일 작성에 관한 보조 자료<a class="headerlink" href="#id14" title="제목 주소">¶</a></h4>
<blockquote>
<div><p>테스트 패턴 파일의 포트 번호 값을 지정하는 부분에 옵션 인수의 이름을 지정하면
테스트 도구 실행시 해당 값이 옵션 값으로 대체됩니다.
예를 들어, 다음과 같이 테스트 패턴 파일을 작성합니다.</p>
<div class="sourcecode highlight-python"><div class="highlight"><pre>&quot;OFPActionOutput&quot;: {
    &quot;port&quot;:&quot;target_send_port_1&quot;
}
</pre></div>
</div>
<p>그 다음, 다음과 같이 테스트 도구를 실행합니다.</p>
<div class="console highlight-python"><div class="highlight"><pre>root@ryu-vm:~$ ryu-manager --test-switch-target_send_port_1 30 ryu/ryu/tests/switch/tester.py
</pre></div>
</div>
<p>그 결과, 테스트 패턴 파일의 해당 부분이 다음과 같이 테스트 도구에서 해석됩니다.</p>
<div class="sourcecode highlight-python"><div class="highlight"><pre>&quot;OFPActionOutput&quot;: {
    &quot;port&quot;:30
}
</pre></div>
</div>
<p>이렇게하여, 테스트 패턴 파일의 포트 번호 값을
테스트 도구 실행시에 결정할 수 있게 됩니다.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="id15">
<h2>오류 메시지 목록<a class="headerlink" href="#id15" title="제목 주소">¶</a></h2>
<p>이 도구에서 출력되는 오류 메시지 목록을 보여줍니다.</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">오류 메시지</th>
<th class="head">설명</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Failed to initialize flow tables: barrier request timeout.</td>
<td>이전 시험에서 시험 대상 SW의 플로우 항목 삭제 실패 (Barrier Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to initialize flow tables: [err_msg]</td>
<td>마지막 시험에서 시험 대상 SW의 플로우 항목 삭제에 실패 (FlowMod 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Failed to initialize flow tables of tester_sw: barrier request timeout.</td>
<td>이전 시험에서 보조 SW의 플로우 항목 삭제 실패 (Barrier Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to initialize flow tables of tester_sw: [err_msg]</td>
<td>마지막 시험에서 보조 SW의 플로우 항목 삭제 실패 (FlowMod 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Failed to add flows: barrier request timeout.</td>
<td>시험 대상 SW에 대한 플로우 항목 등록 실패 (Barrier Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to add flows: [err_msg]</td>
<td>시험 대상 SW에 대한 플로우 항목 등록 실패 (FlowMod 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Failed to add flows to tester_sw: barrier request timeout.</td>
<td>보조 SW에 대한 플로우 항목 등록 실패 (Barrier Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to add flows to tester_sw: [err_msg]</td>
<td>보조 SW에 대한 플로우 항목 등록 실패 (FlowMod 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Failed to add meters: barrier request timeout.</td>
<td>시험 대상 SW에 대한 미터 항목 등록 실패 (Barrier Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to add meters: [err_msg]</td>
<td>시험 대상 SW에 대한 미터 항목 등록 실패 (MeterMod 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Failed to add groups: barrier request timeout.</td>
<td>시험 대상 SW에 대한 그룹 항목 등록 실패 (Barrier Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to add groups: [err_msg]</td>
<td>시험 대상 SW에 대한 그룹 항목 등록 실패 (GroupMod 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Added incorrect flows: [flows]</td>
<td>시험 대상 SW에 대한 플로우 항목 등록 확인 오류 (예기치 않은 플로우 항목이 등록 된)</td>
</tr>
<tr class="row-odd"><td>Failed to add flows: flow stats request timeout.</td>
<td>시험 대상 SW에 대한 플로우 항목 등록 확인 실패 (FlowStats Request 시간 제한)</td>
</tr>
<tr class="row-even"><td>Failed to add flows: [err_msg]</td>
<td>시험 대상 SW에 대한 플로우 항목 등록 확인 실패 (FlowStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-odd"><td>Added incorrect meters: [meters]</td>
<td>시험 대상 SW에 대한 미터 항목 등록 확인 오류 (예기치 못한 미터 항목이 등록됨)</td>
</tr>
<tr class="row-even"><td>Failed to add meters: meter config stats request timeout.</td>
<td>시험 대상 SW에 대한 미터 항목 등록 확인 실패 (MeterConfigStats Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to add meters: [err_msg]</td>
<td>시험 대상 SW에 대한 미터 항목 등록 확인 실패 (MeterConfigStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Added incorrect groups: [groups]</td>
<td>시험 대상 SW에 대한 그룹 항목 등록 확인 오류 (예기치 못한 그룹 항목이 등록됨)</td>
</tr>
<tr class="row-odd"><td>Failed to add groups: group desc stats request timeout.</td>
<td>시험 대상 SW에 대한 그룹 항목 등록 확인 실패 (GroupDescStats Request 시간 제한)</td>
</tr>
<tr class="row-even"><td>Failed to add groups: [err_msg]</td>
<td>시험 대상 SW에 대한 그룹 항목 등록 확인 실패 (GroupDescStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-odd"><td>Failed to request port stats from target: request timeout.</td>
<td>시험 대상 SW의 PortStats 가져 오지 못함 (PortStats Request 시간 제한)</td>
</tr>
<tr class="row-even"><td>Failed to request port stats from target: [err_msg]</td>
<td>시험 대상 SW의 PortStats 가져 오지 못함 (PortStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-odd"><td>Failed to request port stats from tester: request timeout.</td>
<td>보조 SW의 PortStats 가져 오지 못함 (PortStats Request 시간 제한)</td>
</tr>
<tr class="row-even"><td>Failed to request port stats from tester: [err_msg]</td>
<td>보조 SW의 PortStats 가져 오지 못함 (PortStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-odd"><td>Received incorrect [packet]</td>
<td>예상했던 출력 패킷 수신 오류 (잘못된 패킷을 수신)</td>
</tr>
<tr class="row-even"><td>Receiving timeout: [detail]</td>
<td>예상했던 출력 패킷 수신 실패 (시간 초과)</td>
</tr>
<tr class="row-odd"><td>Failed to send packet: barrier request timeout.</td>
<td>패킷 적용 실패 (Barrier Request 시간 제한)</td>
</tr>
<tr class="row-even"><td>Failed to send packet: [err_msg]</td>
<td>패킷 적용 실패 (Packet-Out 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-odd"><td>Table-miss error: increment in matched_count.</td>
<td>table-miss 확인 오류 (플로우에 match)</td>
</tr>
<tr class="row-even"><td>Table-miss error: no change in lookup_count.</td>
<td>table-miss 확인 오류 (패킷이 대상의 플로우 테이블에서 처리되지 않음)</td>
</tr>
<tr class="row-odd"><td>Failed to request table stats: request timeout.</td>
<td>table-miss 확인 실패 (TableStats Request 시간 제한)</td>
</tr>
<tr class="row-even"><td>Failed to request table stats: [err_msg]</td>
<td>table-miss 확인 실패 (TableStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-odd"><td>Added incorrect flows to tester_sw: [flows]</td>
<td>보조 SW에 대한 플로우 항목 등록 확인 오류 (예기치 않은 플로우 항목이 등록됨)</td>
</tr>
<tr class="row-even"><td>Failed to add flows to tester_sw: flow stats request timeout.</td>
<td>보조 SW에 대한 플로우 항목 등록 확인 실패 (FlowStats Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to add flows to tester_sw: [err_msg]</td>
<td>보조 SW에 대한 플로우 항목 등록 확인 실패 (FlowStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Failed to request flow stats: request timeout.</td>
<td>처리량 확인시 보조 SW에 대한 플로우 항목 등록 확인 실패 (FlowStats Request 시간 제한)</td>
</tr>
<tr class="row-odd"><td>Failed to request flow stats: [err_msg]</td>
<td>처리량 확인시 보조 SW에 대한 플로우 항목 등록 확인 실패 (FlowStats Request에 대한 Error 메시지 수신)</td>
</tr>
<tr class="row-even"><td>Received unexpected throughput: [detail]</td>
<td>기대치 처리량에서 동떨어진 처리량 측정</td>
</tr>
<tr class="row-odd"><td>Disconnected from switch</td>
<td>시험 대상 SW 또는 보조 SW에서 링크 단선 발생</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">목차</a></h3>
  <ul>
<li><a class="reference internal" href="#">OpenFlow 스위치 테스트 도구</a><ul>
<li><a class="reference internal" href="#id1">테스트 도구의 개요</a><ul>
<li><a class="reference internal" href="#id2">시험 실행 이미지</a></li>
<li><a class="reference internal" href="#id3">시험 결과의 출력 이미지</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">사용 방법</a><ul>
<li><a class="reference internal" href="#id5">도구 실행 환경</a></li>
<li><a class="reference internal" href="#id6">테스트 도구 실행 환경</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">테스트 도구 사용 예</a><ul>
<li><a class="reference internal" href="#id8">샘플 테스트 패턴의 실행 단계</a><ul>
<li><a class="reference internal" href="#id9">&lt;참고&gt;샘플 테스트 패턴 파일 목록</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">기존 테스트 패턴의 실행 단계</a></li>
<li><a class="reference internal" href="#id11">테스트 패턴 파일 작성 방법</a><ul>
<li><a class="reference internal" href="#id12">＜참고＞적용 패킷의 전송 이미지</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13">포트 번호 변경 방법</a><ul>
<li><a class="reference internal" href="#id14">&lt;참고&gt;테스트 패턴 파일 작성에 관한 보조 자료</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id15">오류 메시지 목록</a></li>
</ul>
</li>
</ul>

  <h4>이전 항목</h4>
  <p class="topless"><a href="rest_qos.html"
                        title="이전 장">QoS</a></p>
  <h4>다음 항목</h4>
  <p class="topless"><a href="arch.html"
                        title="다음 장">아키텍처</a></p>
  <h3>현재 문서</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/switch_test_tool.txt"
           rel="nofollow">소스 코드를 보려면</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>빠른 검색</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="바로 가기" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    모듈, 클래스 또는 함수 이름을 입력하십시오.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>탐색</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="전체 색인"
             >색인</a></li>
        <li class="right" >
          <a href="arch.html" title="아키텍처"
             >다음</a> |</li>
        <li class="right" >
          <a href="rest_qos.html" title="QoS"
             >이전</a> |</li>
        <li><a href="index.html">Ryubook 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, RYU project team.
    </div>
  </body>
</html>